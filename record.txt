simulation_mutral_Detection


### PARAMETER SELECTION #############################################################################################################
matplotlib.rcParams['pdf.fonttype'] = 42
matplotlib.rcParams['ps.fonttype'] = 42
np.random.seed(1)

T = 10
dt = 1

A_0 = np.block([[np.zeros([2, 2]), np.eye(2)], [np.zeros([2, 2]), np.zeros([2, 2])]])
B_0 = np.block([[np.zeros([2, 2])], [np.eye(2)]])
A = sp.linalg.expm(A_0 * dt)
B = np.sum([np.linalg.matrix_power(A_0 * dt, i) / math.factorial(i + 1) for i in np.arange(100)], axis=0).dot(B_0)
C = np.block([[np.eye(2), np.zeros([2, 2])]])

C_test = np.array([
    [1, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 1, 0, 0, 0],
    [0, 1, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 1, 0, 0],
])

A_joint = sp.linalg.block_diag(A, A)
B_joint = sp.linalg.block_diag(B, B)
C_joint = C_test

A_list = (T + 1) * [A_joint]
B_list = (T + 1) * [B_joint]
C_list = (T + 1) * [C_joint]

max_v1 = 2
max_v2 = 4
max_x0 = 1
max_v0 = 0
box_x = 15

comm_dist = 12

center_times_uav1 = (T + 1) * [[0, 0, 0, 0]]
center_times_uav2 = (T + 1) * [[0, 0, 0, 0]]
radius_times_uav1 = (T + 1) * [[box_x, box_x, max_v1, max_v1]]
radius_times_uav2 = (T + 1) * [[box_x, box_x, max_v2, max_v2]]

box_check = [0,10]

center_times_uav1[box_check[0]] = [-5, 4, 0, 0]
radius_times_uav1[box_check[0]] = [max_x0, max_x0, max_v0, max_v0]
# center_times_uav1[box_check[1]] = [0, 4, 0, 0]
# radius_times_uav1[box_check[1]] = [3, 3, max_v, max_v]
center_times_uav1[box_check[1]] = [5, 4, 0, 0]
radius_times_uav1[box_check[1]] = [5, 5, 1, 1]

center_times_uav2[box_check[0]] = [-5, -5, 0, 0]
radius_times_uav2[box_check[0]] = [max_x0, max_x0, max_v0, max_v0]
# center_times_uav2[box_check[1]] = [0, -5, 0, 0]
# radius_times_uav2[box_check[1]] = [3, 3, max_v, max_v]
center_times_uav2[box_check[1]] = [5, -4, 0, 0]
radius_times_uav2[box_check[1]] = [1.5, 1.5, 1, 1]

center_times = [center_times_uav1[i] + center_times_uav2[i] for i in range(T + 1)]
radius_times = [radius_times_uav1[i] + radius_times_uav2[i] for i in range(T + 1)]

Poly_x = cart_H_cube(center_times, radius_times)


uav1_x_max = 1.2
uav1_y_max = 0.2
uav2_x_max = 4.0
uav2_y_max = 4.0
Poly_u = H_cube([0, 0, 0, 0],[uav1_x_max, uav1_y_max, uav2_x_max, uav2_y_max]).cartpower(T + 1)



wx_1_scale = 0.2
wy_1_scale = 0.4
wx_2_scale = 0.05
wy_2_scale = 0.05
wxdot_1_scale = 0.05
wydot_1_scale = 0.08
wxdot_2_scale = 0.05
wydot_2_scale = 0.05

v_scale = 0.05
delta = 0.01
RTH_opt_eps = 1e-11
sparse_opt_eps = 1e-10
rank_eps = 1e-7
N = 8

Poly_w = H_cube(center_times[0], radius_times[0]).cart(
    H_cube([0, 0, 0, 0, 0, 0, 0, 0], [wx_1_scale,wy_1_scale,wx_2_scale,wy_2_scale,wxdot_1_scale,wydot_1_scale,wxdot_2_scale,wydot_2_scale]).cartpower(T)
).cart(H_cube([0, 0, 0, 0], [v_scale] * 4).cartpower(T + 1))

# H_comm = np.array([
#     [ 1,  1,  0,  0, -1, -1,  0,  0],  # (x1 - x2) + (y1 - y2) <= comm_dist
#     [ 1, -1,  0,  0, -1,  1,  0,  0],
#     [-1,  1,  0,  0,  1, -1,  0,  0],
#     [-1, -1,  0,  0,  1,  1,  0,  0],
# ])
# h_comm = comm_dist * np.ones(4)
# Poly_comm_single = Polytope(H_comm, h_comm)
# Poly_comm = Poly_comm_single.cartpower(T + 1)

Poly_comm = partial_time_dist_poly([3,7], T, dist=5)
Poly_x = poly_intersect(Poly_x, Poly_comm)




test_feas = True
file = "simulation_results/simulationT10_joint.pickle"
save = True




























--- Baseline Communication Messages ----------------------------------------------------
Reweighted Nuclear Norm: 9.046596805006857e-12
UAV2->UAV1 messages: 9
UAV1->UAV2 messages: 9

--- Offdiag Communication -----------------------------------------------------
Com time: 143.1819064617157
Error truncated polytope constraint (Offdiag): 2.2406446431588734e-07
rank K (offdiag): 34
band (D,E) = messages (offdiag): 34
Reweighted Nuclear Norm: 6.575279731801942e-08
UAV2->UAV1 messages (offdiag): 11
UAV1->UAV2 messages (offdiag): 11
messages from rank: 10 10
Supposed Rank of L1 and L2:
Rank(L1), Rank(L2) in Phi_uy: 6 6
F, L21, L12 have been written to 'OffdiagMatrices.txt' for inspection.

--- Offdiag Communication diagI ------------------------------------
Com time diagI: 578.50181889534
Reweighted Nuclear Norm: 8.746611557253203e-08
UAV2->UAV1 messages diagI: 6
UAV1->UAV2 messages diagI: 6
Supposed Rank of L1 and L2:
Rank(L1), Rank(L2) in Phi_uy: 6 6